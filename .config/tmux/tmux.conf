#Basic settings
set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",*:RGB"

set -g base-index 1
setw -g pane-base-index 1
set -s escape-time 0
set -g mouse on
setw -g mode-keys vi
set -g history-limit 50000
set -g renumber-windows on

set -g visual-activity off
set -g visual-bell off
set -g visual-silence off
setw -g monitor-activity off
set -g bell-action none

# Bindings
set -g prefix C-a
unbind C-b
bind C-a send-prefix

bind c new-window -c "#{pane_current_path}"
bind x kill-pane
bind X kill-window
bind r source-file ~/.config/tmux/tmux.conf \; display "reloaded"
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send -X copy-selection-and-cancel

bind C-g display-popup \
  -d "#{pane_current_path}" \
  -w 80% \
  -h 80% \
  -E "lazygit"
bind C-j display-popup -E "tmux list-sessions | sed -E 's/:.*$//' | grep -v \"^$(tmux display-message -p '#S')\$\" | fzf --reverse | xargs tmux switch-client -t"

#Plugins
set -g @plugin 'tmux-plugins/tpm'

set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @resurrect-dir '~/.local/share/tmux/resurrect'
set -g @resurrect-capture-pane-contents 'on'
set -g @resurrect-strategy-nvim 'session'

set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @continuum-restore 'on'
set -g @continuum-save-interval '5'

set -g @plugin 'Nybkox/tmux-kanagawa'
set -g @kanagawa-refresh-rate 5
set -g @kanagawa-plugins 'time'
set -g @kanagawa-ignore-window-colors true
set -g @kanagawa-show-left-icon session

run '~/.tmux/plugins/tpm/tpm'

setw -g window-status-format "#[fg=#dcd7ba]#[bg=#2a2a37] #I #W "
setw -g window-status-current-format "#[fg=#dcd7ba,bg=#54546D] #I #W "
setw -g window-status-separator ""
set -g status-right-length 100
set -g status-right "#(~/.tmux/plugins/tmux-continuum/scripts/continuum_save.sh) #[fg=#dcd7ba,bg=#54546D] %-I:%M %p "
set -g status-interval 5
set -g status-position top
